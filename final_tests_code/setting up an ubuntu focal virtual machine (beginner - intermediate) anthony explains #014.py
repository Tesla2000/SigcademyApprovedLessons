import random
import langchain_openai
import langchain_core
def generate_questions() -> list[str]:
    questions = ['What is the purpose of setting a password during installation?', 'Which virtual machine manager is being used in the installation process?', 'What virtual machine manager does the speaker use?', 'What Linux image version is the speaker using for the virtual machine setup?', 'How much memory does the speaker recommend allocating for the virtual machine with 8GB of RAM?', 'What is the default setting for the hard disk allocation in the virtual machine setup?', 'Why does the user prefer to use fixed size allocation for the hard disk in the virtual machine setup?', 'What setting does the user change in the advanced tab of the virtual machine settings?', 'What additional settings does the user customize in the virtual machine setup for better performance?', 'Where do the speaker usually set up the shared folder in VirtualBox?', 'What setting do the speaker enable to automatically mount the shared folder in VirtualBox?', 'What type of installation do the speaker prefer in VirtualBox for faster setup?', 'What animal is Ubuntu 20.04 named after?', 'What are the necessary steps to set up guest additions in VirtualBox?', 'Why are guest additions necessary in VirtualBox?', 'Can the setup process for guest additions be applied to other Linux distributions?']
    return random.sample(questions, min(len(questions), 5))


def generate_answers(question: str, answer: str, _: str) -> bool | str:
    reference_answers = dict(zip(['What is the purpose of setting a password during installation?', 'Which virtual machine manager is being used in the installation process?', 'What virtual machine manager does the speaker use?', 'What Linux image version is the speaker using for the virtual machine setup?', 'How much memory does the speaker recommend allocating for the virtual machine with 8GB of RAM?', 'What is the default setting for the hard disk allocation in the virtual machine setup?', 'Why does the user prefer to use fixed size allocation for the hard disk in the virtual machine setup?', 'What setting does the user change in the advanced tab of the virtual machine settings?', 'What additional settings does the user customize in the virtual machine setup for better performance?', 'Where do the speaker usually set up the shared folder in VirtualBox?', 'What setting do the speaker enable to automatically mount the shared folder in VirtualBox?', 'What type of installation do the speaker prefer in VirtualBox for faster setup?', 'What animal is Ubuntu 20.04 named after?', 'What are the necessary steps to set up guest additions in VirtualBox?', 'Why are guest additions necessary in VirtualBox?', 'Can the setup process for guest additions be applied to other Linux distributions?'], ['The password is mainly used to prevent accidental execution of sensitive commands, such as running sudo on the wrong thing.', 'VirtualBox is being used as the virtual machine manager in the installation process.', 'VirtualBox', 'Ubuntu 20.04 (Focal Fossa)', '3072 MB', 'The default setting is dynamically allocated.', 'The user prefers fixed size allocation because it pre-allocates the disk space and provides limits, making it faster compared to dynamically allocated drives.', 'The user usually enables shared clipboard in a bi-directional way and adjusts the number of processors to half minus one of the available virtual CPUs.', 'The user also adjusts the PAE/NX and VTX settings if available, maximizes the screen video memory, enables 3D acceleration, and sets up a shared folder for easy file transfer.', "Next to the virtual machine, in a separate folder like 'Ubuntu_2004_shared'", 'Auto mounts option', 'Minimal installation', 'Ubuntu 20.04 is named after the fossa, an animal found in Madagascar.', "1. Press ENTER when prompted for installation media.\n2. Open a terminal using the keyboard shortcut Ctrl+Alt+T or through the Windows key/command key.\n3. Install three packages using the command 'sudo apt update' and 'sudo apt install GCC perl make --no-install-recommends'.\n4. Go to the devices menu in the virtual machine and click 'Insert Guest Additions CD image'.\n5. Run the installation prompt, type your password, and install the kernel module.\n6. Reboot the virtual machine to finish the setup.", 'Guest additions are necessary to enable features like clipboard sharing, drag and drop functionality, and shared folders between the host and guest operating systems in VirtualBox.', 'Yes, the setup process for guest additions in VirtualBox is similar for other Linux distributions as well. The steps involving installing packages, mounting the CD image, and installing the kernel module are common across different distributions.']))
    chat = langchain_openai.ChatOpenAI(model="gpt-3.5-turbo-1106", temperature=0)
    chat_answer = chat.invoke(
        [
            langchain_core.messages.SystemMessage(content="You will be given question, reference answer pair and users answer. "
                                  'You have to decide if the answer is correct. '
                                  'If it is respond with a single work "Correct" otherwise return a hint about the answer. '),
            langchain_core.messages.SystemMessage(content='The question: ' + question + '\n'
                                  'The reference answer: ' + reference_answers[question]),
            langchain_core.messages.HumanMessage(
                content=answer
            )
        ]
    ).content
    if chat_answer.startswith("Correct"):
        return True
    return chat_answer
