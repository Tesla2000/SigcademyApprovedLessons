import random
import langchain_openai
import langchain_core
def generate_questions() -> list[str]:
    questions = ['What is the purpose of the for else statement in Python?', 'How does the for else statement work in Python?', 'Can the speaker provide an example of using the for else statement in Python?', "What is the purpose of the 'for else' statement in Python?", "Can the speaker provide an example of using 'for else' in Python?", 'What is enumerate used for?', 'How can the speaker handle cases where a character is not found in a string using enumerate?', 'What tool did the user use to search for specific patterns in their code bases?', "What is the purpose of the node visitor class in the user's code snippet?", "Can the speaker provide an example of the user's code where they used 'for else' in their text editor?", 'What is the purpose of the code snippet?', 'What is the special function mentioned in Python 3.9 that helps with removing line endings?', 'How does the code snippet handle cases where a line does not end with a new line character?', "Can the speaker explain the use of 'for else' statement in the code snippet?"]
    return random.sample(questions, min(len(questions), 5))


def generate_answers(question: str, answer: str, _: str) -> bool | str:
    reference_answers = dict(zip(['What is the purpose of the for else statement in Python?', 'How does the for else statement work in Python?', 'Can the speaker provide an example of using the for else statement in Python?', "What is the purpose of the 'for else' statement in Python?", "Can the speaker provide an example of using 'for else' in Python?", 'What is enumerate used for?', 'How can the speaker handle cases where a character is not found in a string using enumerate?', 'What tool did the user use to search for specific patterns in their code bases?', "What is the purpose of the node visitor class in the user's code snippet?", "Can the speaker provide an example of the user's code where they used 'for else' in their text editor?", 'What is the purpose of the code snippet?', 'What is the special function mentioned in Python 3.9 that helps with removing line endings?', 'How does the code snippet handle cases where a line does not end with a new line character?', "Can the speaker explain the use of 'for else' statement in the code snippet?"], ['The for else statement in Python allows for an else block to be executed after a for loop completes naturally without encountering a break statement.', 'The else block of a for else statement in Python is executed only if the for loop completes without encountering a break statement. If the loop exits naturally, the else block is executed.', "Sure! Here's an example:\n\n```python\nfor i in range(1, 6):\n    if i == 5:\n        print('Found 5!')\n        break\nelse:\n    print('Number not found')\n```\n\nIn this example, the else block will be executed only if the loop completes without finding the number 5.", "The 'for else' statement in Python is used to execute a block of code if a loop completes without encountering a 'break' statement.", "Sure, here is an example:\n\n```python\nnumbers = [1, 2, 3, 4, 5]\nfor num in numbers:\n    if num == 5:\n        print('Found 5!')\n        break\nelse:\n    print('Did not find 5!')\n```\nIn this example, the 'else' block will be executed only if the loop completes without encountering the number 5.", 'Enumerate is a built-in function in Python that adds an index to an iterable and returns it as a tuple.', 'If the character is not found in the string, the index will be set to -1 and returned.', 'The user used a tool called all repos to grep through all of their code bases and find interesting patterns.', 'The node visitor class is used to traverse the abstract syntax tree (AST) in Python and find all the places where the else block occurs in for loops or while loops.', "One example is in the user's text editor called babby, where they use 'for else' to find the syntax highlighter for a file based on its grammar.", 'The code snippet is looping through every line in a file and counting the occurrences of different types of line endings. It also builds up a list of lines that do not have a line ending. Additionally, it handles cases where the last line in the file may not end with a new line character.', "The special function mentioned in Python 3.9 is 'strip suffix' which can remove line endings from strings.", 'If a line does not end with a new line character, which typically happens for the last line in the file, the code still appends the line but does not perform the special slicing operation.', "The 'for else' statement is used in a loop to iterate through regular expressions and lines in the source. If any of the regular expressions match a line, the loop breaks. If none of the regular expressions match, an assertion error is raised. The 'for else' statement provides a clear and readable way to handle this logic."]))
    chat = langchain_openai.ChatOpenAI(model="gpt-3.5-turbo-1106", temperature=0)
    chat_answer = chat.invoke(
        [
            langchain_core.messages.SystemMessage(content="You will be given question, reference answer pair and users answer. "
                                  'You have to decide if the answer is correct. '
                                  'If it is respond with a single work "Correct" otherwise return a hint about the answer. '),
            langchain_core.messages.SystemMessage(content='The question: ' + question + '\n'
                                  'The reference answer: ' + reference_answers[question]),
            langchain_core.messages.HumanMessage(
                content=answer
            )
        ]
    ).content
    if chat_answer.startswith("Correct"):
        return True
    return chat_answer
